<UserControl
    x:Class="GIMI_ModManager.WinUI.Views.Settings.CreateCommandView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:controls1="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:controls2="using:GIMI_ModManager.WinUI.Views.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:l="using:WinUI3Localizer"
    xmlns:local="using:GIMI_ModManager.WinUI.Views.Settings"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <StackPanel Margin="0,0,0,16">
            <TextBlock 
                FontSize="18" 
                Text="Create Command" 
                l:Uids.Uid="/Settings/CreateCommand_Title"/>
            <TextBox
                MinWidth="300"
                HorizontalAlignment="Left"
                Header="* Command Name:"
                PlaceholderText="Command display name (Required)"
                Text="{x:Bind ViewModel.CommandDisplayName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                l:Uids.Uid="/Settings/CreateCommand_NameInput"/>
        </StackPanel>



        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>

            <controls:Segmented
                HorizontalAlignment="Center"
                SelectedIndex="0"
                SelectionMode="Single">
                <controls:SegmentedItem 
                    Content="Custom Command" 
                    l:Uids.Uid="/Settings/CreateCommand_Type_Custom"/>
                <controls:SegmentedItem
                    Content="Custom Chained Command"
                    IsEnabled="False"
                    ToolTipService.ToolTip="Not Implemented"
                    l:Uids.Uid="/Settings/CreateCommand_Type_Chained"/>
            </controls:Segmented>


            <controls1:SwitchPresenter Grid.Row="1" Value="Custom Command">
                <controls1:Case Value="Custom Command">
                    <ScrollViewer>

                        <StackPanel Spacing="8">
                            <controls2:FolderSelector
                                Title="* Executable"
                                BrowseCommand="{x:Bind ViewModel.SelectExecutableCommand}"
                                PlaceHolderText="Must be in $PATH or an absolute path to the executable (Required)"
                                SelectedFolderValue="{x:Bind ViewModel.Command, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                l:Uids.Uid="/Settings/CreateCommand_ExecutableInput"/>

                            <controls2:FolderSelector
                                Title="Working Directory"
                                BrowseCommand="{x:Bind ViewModel.SelectWorkingDirectoryCommand}"
                                Footer="{x:Bind ViewModel.EffectiveWorkingDirectory, Mode=OneWay}"
                                IsEnabled="{x:Bind ViewModel.CanEditWorkingDirectory, Mode=OneWay}"
                                PlaceHolderText="Folder must exist when manually specifying path"
                                SelectedFolderValue="{x:Bind ViewModel.WorkingDirectory, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                l:Uids.Uid="/Settings/CreateCommand_WorkDirInput"/>

                            <StackPanel>
                                <TextBox
                                    Header="Arguments"
                                    PlaceholderText="Arguments passed to the executable"
                                    Text="{x:Bind ViewModel.Arguments, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    l:Uids.Uid="/Settings/CreateCommand_ArgsInput"/>
                                <TextBlock 
                                    IsTextSelectionEnabled="True" 
                                    Text="When command is run against a file system object (i.e. a skin/mod folder), {{TargetPath}} will be replaced by the actual path." 
                                    l:Uids.Uid="/Settings/CreateCommand_ArgsHelp"/>
                            </StackPanel>


                            <StackPanel>
                                <CheckBox
                                    Content="Kill process on JASM exit"
                                    IsChecked="{x:Bind ViewModel.KillProcessOnMainAppExit, Mode=TwoWay}"
                                    ToolTipService.ToolTip="If checked, the process will be terminated when JASM exits"
                                    l:Uids.Uid="/Settings/CreateCommand_KillOnExit"/>
                                <CheckBox
                                    Command="{x:Bind ViewModel.ToggleRunAsAdminCommand}"
                                    Content="Run as Administrator"
                                    IsChecked="{x:Bind ViewModel.RunAsAdmin, Mode=TwoWay}"
                                    ToolTipService.ToolTip="Run as Administrator"
                                    l:Uids.Uid="/Settings/CreateCommand_RunAsAdmin"/>
                                <CheckBox
                                    Command="{x:Bind ViewModel.ToggleUseShellExecuteCommand}"
                                    Content="Use Shell Execute"
                                    IsChecked="{x:Bind ViewModel.UseShellExecute, Mode=TwoWay}"
                                    IsEnabled="{x:Bind ViewModel.CanToggleUseShellExecute, Mode=OneWay}"
                                    ToolTipService.ToolTip="If checked, the operating system will be used to start the executable"
                                    l:Uids.Uid="/Settings/CreateCommand_UseShellExecute"/>
                                <CheckBox
                                    Content="Create New Window"
                                    IsChecked="{x:Bind ViewModel.CreateWindow, Mode=TwoWay}"
                                    IsEnabled="False"
                                    ToolTipService.ToolTip="If checked, it will run in an external window"
                                    l:Uids.Uid="/Settings/CreateCommand_NewWindow"/>
                            </StackPanel>

                        </StackPanel>
                    </ScrollViewer>

                </controls1:Case>
            </controls1:SwitchPresenter>

        </Grid>

        <StackPanel Grid.Row="2" Spacing="16">
            <TextBox
                Header="Command Preview:"
                IsReadOnly="True"
                Text="{x:Bind ViewModel.CommandPreview, Mode=OneWay}"
                l:Uids.Uid="/Settings/CreateCommand_Preview"/>
            <Button
                Command="{x:Bind ViewModel.CreateCommandCommand}"
                Content="Save Command"
                Style="{ThemeResource AccentButtonStyle}"
                l:Uids.Uid="/Settings/CreateCommand_SaveButton"/>
        </StackPanel>


    </Grid>
</UserControl>